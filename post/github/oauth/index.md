# Github App 及 OAuth



** 令牌与密码

令牌（token）与密码（password）的作用是一样的，都可以进入系统，但是有三点差异。

1) 令牌是短期的，到期会自动失效，用户自己无法修改。密码一般长期有效，用户不修改，就不会发生变化。

2) 令牌可以被数据所有者撤销，会立即失效。密码一般不允许被他人撤销。

3) 令牌有权限范围（scope）。对于网络服务来说，只读令牌就比读写令牌更安全。密码一般是完整权限。

保证了令牌既可以让第三方应用获得权限，同时又随时可控，不会危及系统安全。这就是 OAuth 2.0 的优点。

*OAuth 的核心就是向第三方应用颁发令牌。*

** 获得令牌的流程

OAuth 2.0 规定了四种获得令牌的流程。

**** 授权码（authorization-code）

第三方应用先申请一个授权码，然后再用该码获取令牌。

最常用的流程，安全性也最高，它适用于那些有后端的 Web 应用。

**** 隐藏式（implicit）

允许直接向前端颁发令牌。这种方式没有授权码这个中间步骤，所以称为（授权码）"隐藏式"（implicit）。

**** 密码式（password）

如果你高度信任某个应用，RFC 6749 也允许用户把用户名和密码，直接告诉该应用。该应用就使用你的密码，申请令牌，这种方式称为"密码式"（password）。

**** 客户端凭证（client credentials）

适用于没有前端的命令行应用，即在命令行下请求令牌。

** 第三方登录的原理

所谓第三方登录，实质就是 OAuth 授权。用户想要登录 A 网站，A 网站让用户提供第三方网站的数据，证明自己的身份。获取第三方网站的身份数据，就需要 OAuth 授权。

举例来说，A 网站允许 GitHub 登录，背后就是下面的流程。

1. A 网站让用户跳转到 GitHub。
2. GitHub 要求用户登录，然后询问"A 网站要求获得 xx 权限，你是否同意？"
3. 用户同意，GitHub 就会重定向回 A 网站，同时发回一个授权码。
4. A 网站使用授权码，向 GitHub 请求令牌。
5. GitHub 返回令牌.
6.A 网站使用令牌，向 GitHub 请求用户数据。

** Github App & OAuth App
Github App 可以通过 Github 提供的认证信息去调用 Github API。

- OAuth App 所获取的权限都是固定且只读的，用户只能读取固定的数据而不能修改数据；
- Github App 几乎可以获取 Github 提供的所有功能权限，且所获取的权限可以被设定为“只读”，“可读可写”和“禁止访问”，对于权限的授权粒度会更细。



